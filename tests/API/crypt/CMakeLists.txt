set(PROBE_HEADERS "${CMAKE_SOURCE_DIR}/src/OVAL/probes/")
set(CRAPI_HEADERS "${CMAKE_SOURCE_DIR}/src/OVAL/probes/crapi/")
file(GLOB_RECURSE CRAPI_SOURCES "${CMAKE_SOURCE_DIR}/src/OVAL/probes/crapi/*.c")
add_oscap_test_executable(test_crapi_digest "test_crapi_digest.c" ${CRAPI_SOURCES})
add_oscap_test_executable(test_crapi_mdigest "test_crapi_mdigest.c" ${CRAPI_SOURCES})
target_include_directories(test_crapi_digest PUBLIC ${PROBE_HEADERS} ${CRAPI_HEADERS} ${NSS_INCLUDE_DIRS})
target_include_directories(test_crapi_mdigest PUBLIC ${PROBE_HEADERS} ${CRAPI_HEADERS} ${NSS_INCLUDE_DIRS})
target_link_libraries(test_crapi_digest openscap)
target_link_libraries(test_crapi_mdigest openscap)
add_oscap_test("test_api_crypt.sh")
